# 播放记录功能特性清单

## 特性概述
本特性用于记录每首歌曲的播放详情，包括歌曲信息、播放时间、是否已同步到Last.fm等信息，并提供查询未同步记录和手动同步功能。

## 功能要点
1. 播放记录表设计：
   - 包含歌曲的详细信息（艺术家、专辑、曲名等）
   - 记录播放时间和是否已同步到Last.fm的状态
   - 包含MusicBrainz ID和音轨号等元数据
   - 区分播放来源（Audirvana或Roon）

2. 数据操作：
   - 在检测到歌曲播放完成时自动保存播放记录
   - 支持查询未同步到Last.fm的播放记录
   - 支持更新记录的同步状态

3. 手动同步功能：
   - 提供命令行接口手动同步未同步的播放记录
   - 支持限制同步记录的数量
   - 在同步后更新记录的同步状态

4. 数据库设计：
   - 表名：track_play_records
   - 主键：id（自增）
   - 索引：artist（普通索引）、scrobbled（普通索引）
   - 时间戳：created_at、updated_at（由GORM自动管理）

## 实现细节
1. 数据模型：
   - 使用GORM ORM框架管理数据库操作
   - 通过gorm标签定义表结构和索引
   - 自动迁移表结构

2. 核心方法：
   - InsertTrackPlayRecord：插入播放记录
   - UpdateScrobbledStatus：更新同步状态
   - GetUnscrobbledRecords：获取未同步记录

3. 集成：
   - 在播放检测逻辑中集成记录保存
   - 在手动同步命令中使用记录查询和状态更新

## 扩展性考虑
1. 表结构支持添加更多歌曲元数据字段
2. 可以扩展更多查询维度（如按时间范围、按来源等）
3. 可以添加更多的同步状态（如部分同步、同步失败等）